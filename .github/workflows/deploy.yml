name: Deploy Frontend to AWS EC2

on:
  push:
    branches:
      - master  # Change this if you deploy from a different branch

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸš€ Checkout Repository
        uses: actions/checkout@v4

- name: ðŸ”‘ Setup SSH Key
  run: |
    mkdir -p ~/.ssh
    echo "${{ secrets.EC2_SSH_PRIVATE_KEY }}" > ~/.ssh/id_rsa
    chmod 600 ~/.ssh/id_rsa
    ssh-keyscan -H ${{ secrets.EC2_HOST }} >> ~/.ssh/known_hosts
- name: ðŸ“¦ Install Node.js
  uses: actions/setup-node@v4
  with:
    node-version: 18 # Adjust based on your project needs
    cache: 'npm'

- name: ðŸ“¥ Install Dependencies
  run: npm install

- name: ðŸŒ Set up Environment Variables
  run: echo "VITE_API_BASE_URL=${{ secrets.VITE_API_BASE_URL }}" > .env

- name: âš¡ Build React + Vite
  run: npm run build

- name: ðŸš€ Deploy to EC2
  run: |
    scp -r dist/* ${{ secrets.EC2_USER }}@${{ secrets.EC2_HOST }}:/var/www/html

